<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>

		<template id="l10n_ro_report_invoice" inherit_id="account.report_invoice">
			<xpath expr="." position="inside">
				<t t-if="False">
					<t t-call="account.report_invoice_document" />
				</t>
			</xpath>
		</template>


		<template id="header_invoice">
			<xpath expr="//div[@class='header']" position="replace">
				<div class="header">
					<!--div class="row" customize_show="True" >
						<div class="col-xs-3">
							<img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 45px;"/>
						</div>
						<div class="col-xs-9 text-right" style="margin-top:20px;" t-field="company.rml_header1"/>
					</div-->
					<div class="row zero_min_height">
						<div class="col-xs-12">
							<div style="border-bottom: 1px solid black;"/>
						</div>
					</div>

    			<div class="row">
					<div class="col-xs-5">
						<div>
							<strong t-if="o.type == 'out_invoice'">Supplier</strong>
							<strong t-if="o.type == 'in_invoice'">Customer</strong>
						</div>
						<strong t-field="res_company.partner_id.name"/>
						<div>
							<strong>Address:</strong>
							<address t-field="res_company.partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;,&quot;phone&quot;, &quot;fax&quot;], &quot;no_marker&quot;: false, &quot;no_tag_br&quot;: true}"/>
						</div>

					</div>

					<div class="col-xs-5 col-xs-offset-2">
						<div>
							<strong t-if="o.type == 'out_invoice'">Customer</strong>
							<strong t-if="o.type == 'in_invoice'">Supplier</strong>
						</div>
						<div>
							<strong t-field="o.commercial_partner_id.name"/>
						</div>
						<div>
							<strong>Address:</strong>
							<address t-field="o.commercial_partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;phone&quot;, &quot;fax&quot;], &quot;no_marker&quot;: false, &quot;no_tag_br&quot;: true}"/>
						</div>

					</div>
				</div>
				<small>
					<div class="row">
						<div class="col-xs-6">
							<div t-foreach="res_company.partner_id.bank_ids" t-as="bank">
								<div t-if="bank.footer">
									<span t-if="bank.bank_name">
										<strong>Bank:</strong>
										<span t-field="bank.bank_name"/>
									</span>
									<span t-if="bank.acc_number">
										<strong>Account:</strong>
										<span t-field="bank.acc_number"/>
									</span>
								</div>
							</div>
						</div>
						<div class="col-xs-5 col-xs-offset-1">
							<div t-foreach="o.commercial_partner_id.bank_ids" t-as="bank">
								<span t-if="bank.bank_name">
									<strong>Bank:</strong>
									<span t-field="bank.bank_name"/>
								</span>
								<span t-if="bank.acc_number">
									<strong>Account:</strong>
									<span t-field="bank.acc_number"/>
								</span>
							</div>
						</div>
					</div>
				</small>

				<div class="row">
					<div class="col-xs-5">
						<div t-if="res_company.partner_id.vat">
							<strong>CIF:</strong>
							<span t-field="res_company.partner_id.vat"/>
						</div>
						<div t-if="res_company.partner_id.nrc">
							<strong>NRC:</strong>
							<span t-field="res_company.partner_id.nrc"/>
						</div>
						<div t-if="res_company.share_capital">
							<strong>Share Capital:</strong>
							<span t-field="res_company.share_capital"/>
						</div>
						<div t-if="'vat_on_payment' in res_company._columns">
							<div t-if="res_company.vat_on_payment">
								<span>Vat on payment</span>
							</div>
						</div>
						<div>

							<span t-foreach="o.tax_line" t-as="t">
								<span t-field="t.name"/>
							</span>
						</div>
					</div>
					<div class="col-xs-5 col-xs-offset-2">
						<div t-if="o.commercial_partner_id.vat">
							<strong>CIF:</strong>
							<span t-field="o.commercial_partner_id.vat"/>
						</div>
						<div t-if="o.commercial_partner_id.nrc">
							<strong>NRC:</strong>
							<span t-field="o.commercial_partner_id.nrc"/>
						</div>
					</div>
				</div>

                <h4 class="text-center">
                    <span t-if="o.type == 'out_invoice' and (o.state == 'open' or o.state == 'paid')">Invoice</span>
                    <span t-if="o.type == 'out_invoice' and o.state == 'proforma2'">PRO-FORMA</span>
                    <span t-if="o.type == 'out_invoice' and o.state == 'draft'">Draft Invoice</span>
                    <span t-if="o.type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
                    <span t-if="o.type == 'out_refund'">Refund Invoice</span>
                    <span t-if="o.type == 'in_refund'">Supplier Refund</span>
                    <span t-if="o.type == 'in_invoice'">Supplier Invoice</span>
                    <t t-if="o.number">
                    	<span t-field="o.number"/>
                    </t>
                    <t t-if="not o.number">
                    	<span t-field="o.internal_number"/>
                    </t>                   
                    <span> / </span>
    				<span t-field="o.date_invoice" />
    				<div t-if="o.type == 'out_refund'">  
    					<span>Refunding invoice</span>
    					<span t-field="o.origin"/>
    				</div>
                </h4>
         		<div t-if="company.watermark_image"  class="mb32 col-md-12" >
         			<!--  style="-webkit-transform: rotate(-45deg) translateX(-15%);
                      -moz-transform: rotate(-45deg) translateX(-15%);
                      -ms-transform: rotate(-45deg) translateX(-15%);
                      -o-transform: rotate(-45deg) translateX(-15%);
                      transform: rotate(-45deg) translateX(-15%)>" --> 
                      
        
            		<img t-att-src="'data:image/png;base64,%s' % company.watermark_image" 
                    style="width:100%;text-align:center;position:absolute;opacity:0.05"/>
    			</div>
				</div>
			</xpath>
		</template>




		<template id="invoice_layout">
		    <!-- Multicompany -->
		    <t t-if="o and 'company_id' in o">
		        <t t-set="company" t-value="o.company_id"/>
		    </t>
		    <t t-if="not o or not 'company_id' in o">
		        <t t-set="company" t-value="res_company"/>
		    </t>
		
		    <t t-call="l10n_ro_invoice_report.header_invoice"/>
		    <t t-raw="0"/>
		    <t t-call="report.external_layout_footer"/>
		</template>


		<template id="l10n_ro_report_invoice_document" inherit_id="account.report_invoice_document">
			<xpath expr="//t[@t-call='report.external_layout']" position="replace">
			<t t-call="l10n_ro_invoice_report.invoice_layout">
				<div class="page">
					<t t-set="nr_crt" t-value="1" />
					<table class="table table-condensed  table-bordered">
						<thead>
							<tr>
								<th>Ord</th>
								<th>Description</th>
								<th>Quantity</th>
								<th class="text-right">Unit Price</th>
								<th class="text-right" t-if="with_discount(o)" groups="sale.group_discount_per_so_line">Discount (%)</th>
								<th class="text-right">Amount</th>
								<th class="text-right">Taxes</th>
							</tr>
						</thead>
						<tbody class="invoice_tbody">
							<tr t-foreach="o.invoice_line" t-as="l">
								<td>
									<t t-esc="nr_crt" />
									<t t-set="nr_crt" t-value="nr_crt + 1" />
								</td>
								<td>
									<span t-field="l.name" />
								</td>
								<td class="text-right">
									<span t-if="o.type == 'out_refund'">(</span>
									<span t-field="l.quantity" />
									<span t-if="o.type == 'out_refund'">)</span>
									<span t-field="l.uos_id" groups="product.group_uom" />
								</td>
								<td class="text-right">
									<span t-field="l.price_unit_without_taxes" />
								</td>
								<td class="text-right" t-if="with_discount(o)" groups="sale.group_discount_per_so_line">
									<span t-field="l.discount" />
								</td>
								<td class="text-right">
									<span t-if="o.type == 'out_refund'">(</span>
									<span t-field="l.price_subtotal" />
									<span t-if="o.type == 'out_refund'">)</span>
								</td>
								<td class="text-right">
									<span t-if="o.type == 'out_refund'">(</span>
									<span t-field="l.price_taxes" />
									<span t-if="o.type == 'out_refund'">)</span>
								</td>
							</tr>
						</tbody>
					</table>
					<div style="page-break-inside: avoid !important;">
						<div class="row">

							<div class="col-xs-8" t-if="o.type == 'out_invoice' or o.type == 'out_refund' ">
								<table class="table table-condensed">

									<tr class="border-black">
										<td>Elaborate:</td>
										<td>Information for delivery:</td>
									</tr>

									<tr class="border-black">
										<td>
											<span>Name:</span>
											<span t-field="o.user_id" />
										</td>
										<td>
											<div>
												<span>Delegate:</span>
												<span t-field="o.delegate_id" />
											</div>
											<div>
												<span>Mean Transport:</span>
												<span t-field="o.mean_transp" />
											</div>
											<div>
												<span>Signature for receive</span>
											</div>
										</td>
									</tr>
								</table>
							</div>

							<div class="col-xs-4 pull-right">
								<table class="table table-condensed">
									<tr class="border-black">
										<td>
											<strong>Total Without Taxes</strong>
										</td>
										<td class="text-right">
											<span t-if="o.type == 'out_refund'">(</span>
											<span t-field="o.amount_untaxed" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}" />

											<span t-if="o.type == 'out_refund'">)</span>
										</td>
									</tr>
									<tr>
										<td>Taxes</td>
										<td class="text-right">
											<span t-if="o.type == 'out_refund'">(</span>
											<span t-field="o.amount_tax" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}" />
											<span t-if="o.type == 'out_refund'">)</span>
										</td>
									</tr>
									<tr class="border-black">
										<td>
											<strong>Total</strong>
										</td>
										<td class="text-right">
											<span t-if="o.type == 'out_refund'">(</span>
											<span t-field="o.amount_total" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}" />
											<span t-if="o.type == 'out_refund'">)</span>
										</td>
									</tr>
								</table>
							</div>
						</div>



						<p t-if="o.comment">
							<strong>Comment:</strong>
							<span t-field="o.comment" />
						</p>

						<small t-if="o.type == 'out_invoice' or o.type == 'out_refund'">
							<div>Printing and numbering system of its own under Law 571/2003 on the Fiscal Code, with subsequent amendments and OMPF 2226/2006</div>

							<t t-if="not res_company.stamp_image">
								<div>Invoice circulate without signature and stamp according to the law 571/2003, rule 115, paragraph 6</div>
							</t>
							<img t-if="res_company.stamp_image" t-att-src="'data:image/png;base64,%s' % res_company.stamp_image" style="max-height: 150px; " />
						</small>

						<div t-if="o.commercial_partner_id.info_for_invoice">
							<span t-field="o.commercial_partner_id.info_for_invoice" />
						</div>

						<div t-if="o.type == 'out_invoice' and o.payment_ids">
							<br />
							<br />
							<div t-foreach="o.payment_ids" t-as="payment" style="border-top: 1px solid black;">

								<t t-if="payment.credit != 0 and payment.journal_id.type == 'cash'">

									<div>
										<strong t-field="res_company.partner_id.name" />
									</div>
									<div>
										VAT:
										<span t-field="res_company.partner_id.vat" />
									</div>
									<div>
										NRC:
										<span t-field="res_company.partner_id.nrc" />
									</div>
									<address t-field="res_company.partner_id" t-field-options='{"widget": "contact", "fields": ["address"], "no_marker": true, "no_tag_br": true}' />
									<h4>
										<span>Voucher:</span>
										<span t-field="payment.ref" />
										<span>/</span>
										<span t-field="payment.date" />
									</h4>
									<div>
										<span>I received from</span>
										<strong t-field="o.partner_id.name" />
										<span t-if="o.partner_id.city">
											from
											<span t-field="o.partner_id.city" />
											<span t-field="o.partner_id.street" />
											<span t-field="o.partner_id.street2" />
										</span>
										,
										<span>amount</span>

										<span t-field="payment.credit" t-field-options='{"widget": "monetary", "display_currency": "o.currency_id"}' />
										(
										<span t-esc="convert(payment.credit)" />
										)
									</div>
									<div>
										Representing counter value of invoice
										<span t-field="o.number" />
									</div>

								</t>

							</div>
						</div>

						<p t-if="o.payment_term.note">
							<strong>Payment Term:</strong>
							<span t-field="o.payment_term.note" />
						</p>
						<p t-if="o.fiscal_position.note">
							<strong>Fiscal Position Remark:</strong>
							<span t-field="o.fiscal_position.note" />
						</p>
					</div>
				</div>
				</t>
			</xpath>
		</template>


	</data>
</openerp>
