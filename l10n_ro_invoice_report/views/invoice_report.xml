<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>

		<template id="l10n_ro_report_invoice" inherit_id="account.report_invoice">
			<xpath expr="." position="inside">
				<t t-if="False">
					<t t-call="account.report_invoice_document" />
				</t>
			</xpath>
		</template>




		<template id="l10n_ro_report_invoice_document" inherit_id="account.report_invoice_document">

			<xpath expr="//div[@class='row']" position="replace">

				<div class="row">
					<div class="col-xs-5">
						<div>
							<strong t-if="o.type == 'out_invoice'">Supplier</strong>
							<strong t-if="o.type == 'in_invoice'">Customer</strong>
						</div>
						<strong t-field="res_company.partner_id.name" />
						<div>
							<strong>Address:</strong>
							<address t-field="res_company.partner_id" t-field-options='{"widget": "contact", "fields": ["address","phone", "fax"], "no_marker": false, "no_tag_br": true}' />
						</div>

					</div>

					<div class="col-xs-5 col-xs-offset-2">
						<div>
							<strong t-if="o.type == 'out_invoice'">Customer</strong>
							<strong t-if="o.type == 'in_invoice'">Supplier</strong>
						</div>
						<div>
							<strong t-field="o.commercial_partner_id.name" />
						</div>
						<div>
							<strong>Address:</strong>
							<address t-field="o.commercial_partner_id" t-field-options='{"widget": "contact", "fields": ["address", "phone", "fax"], "no_marker": false, "no_tag_br": true}' />
						</div>

					</div>
				</div>
				<small>
					<div class="row">
						<div class="col-xs-6">
							<div t-foreach="res_company.partner_id.bank_ids" t-as="bank">
								<div t-if="bank.footer">
									<span t-if="bank.bank_name">
										<strong>Bank:</strong>
										<span t-field="bank.bank_name" />
									</span>
									<span t-if="bank.acc_number">
										<strong>Account:</strong>
										<span t-field="bank.acc_number" />
									</span>
								</div>
							</div>
						</div>
						<div class="col-xs-5 col-xs-offset-1">
							<div t-foreach="o.commercial_partner_id.bank_ids" t-as="bank">
								<span t-if="bank.bank_name">
									<strong>Bank:</strong>
									<span t-field="bank.bank_name" />
								</span>
								<span t-if="bank.acc_number">
									<strong>Account:</strong>
									<span t-field="bank.acc_number" />
								</span>
							</div>
						</div>
					</div>
				</small>

				<div class="row">
					<div class="col-xs-5">
						<div t-if="res_company.partner_id.vat">
							<strong>CIF:</strong>
							<span t-field="res_company.partner_id.vat" />
						</div>
						<div t-if="res_company.partner_id.nrc">
							<strong>NRC:</strong>
							<span t-field="res_company.partner_id.nrc" />
						</div>
						<div t-if="res_company.share_capital">
							<strong>Share Capital:</strong>
							<span t-field="res_company.share_capital" />
						</div>
						<div t-if="'vat_on_payment' in res_company._columns">
							<div t-if="res_company.vat_on_payment">
								<span>Vat on payment</span>
							</div>
						</div>
						<div>

							<span t-foreach="o.tax_line" t-as="t">
								<span t-field="t.name" />
							</span>
						</div>
					</div>
					<div class="col-xs-5 col-xs-offset-2">
						<div t-if="o.commercial_partner_id.vat">
							<strong>CIF:</strong>
							<span t-field="o.commercial_partner_id.vat" />
						</div>
						<div t-if="o.commercial_partner_id.nrc">
							<strong>NRC:</strong>
							<span t-field="o.commercial_partner_id.nrc" />
						</div>
					</div>
				</div>

			</xpath>
			
			<xpath expr="//span[@t-if=&quot;o.type == 'out_refund'&quot;]" position="replace">
				<span t-if="o.type == 'out_refund'">Refund Invoice</span>
			</xpath>

			<xpath expr="//span[@t-field='o.number']" position="after">
				<span> / </span>
				<span t-field="o.date_invoice" />
				<div t-if="o.type == 'out_refund'">  
					<span>Refunding invoice</span>
					<span t-field="o.origin"/>
				</div>
			</xpath>


			<xpath expr="//div[@class='row mt32 mb32']" position="replace">
			
 			<div t-if="company.watermark_image"  class="mb32 col-md-12"  style="
              -webkit-transform: rotate(-45deg) translateX(-15%);
              -moz-transform: rotate(-45deg) translateX(-15%);
              -ms-transform: rotate(-45deg) translateX(-15%);
              -o-transform: rotate(-45deg) translateX(-15%);
              transform: rotate(-45deg) translateX(-15%)">  

    		<img t-att-src="'data:image/png;base64,%s' % company.watermark_image" 
            style="width:100%;text-align:center;position:absolute;opacity:0.05"/>
			</div>
			</xpath >


			<xpath expr="//table" position="attributes">
				<attribute name="class">table table-condensed table-bordered</attribute>
			</xpath>

			<xpath expr="//table/thead/tr/th[5]" position="replace">
				<th class="text-right">Amount</th>
			</xpath>
			<xpath expr="//table/thead/tr/th[6]" position="replace">
				<th class="text-right">Taxes</th>
			</xpath>

			<xpath expr="//table/thead/tr/th[1]" position="before">
				<th>Ord</th>
				<t t-set="nr_crt" t-value="1" />
			</xpath>

			<xpath expr="//table/thead/tr/th[@groups='sale.group_discount_per_so_line']" position="attributes">
 				<attribute name="t-if">with_discount(o)</attribute>
			</xpath>
 

            <xpath expr="//table/tbody[@class='invoice_tbody']/tr/td[2]/span" position="replace">
                <span t-if="o.type == 'out_refund'">(</span>
                <span t-field="l.quantity"/>
                <span t-if="o.type == 'out_refund'">)</span>
            </xpath>

			<xpath expr="//table/tbody[@class='invoice_tbody']/tr/td[3]/span" position="replace">
				<span t-field="l.price_unit_without_taxes" />
			</xpath>

			<xpath expr="//table/tbody[@class='invoice_tbody']/tr/td[5]/span" position="replace">
			    <span t-if="o.type == 'out_refund'">(</span>
				<span t-field="l.price_subtotal" />
			    <span t-if="o.type == 'out_refund'">)</span>	
			</xpath>


			<xpath expr="//table/tbody[@class='invoice_tbody']/tr/td[6]/span" position="replace">
			    <span t-if="o.type == 'out_refund'">(</span>
				<span t-field="l.price_taxes" />
			    <span t-if="o.type == 'out_refund'">)</span>
			</xpath>

			<xpath expr="//table/tbody[@class='invoice_tbody']/tr/td[1]" position="before">
				<td>
					<t t-esc="nr_crt" />
					<t t-set="nr_crt" t-value="nr_crt + 1" />
				</td>
			</xpath>


			<xpath expr="//table/tbody[@class='invoice_tbody']/tr/td[@groups='sale.group_discount_per_so_line']" position="attributes">
 				<attribute name="t-if">with_discount(o)</attribute>
			</xpath>
			
			
			<xpath expr="//div[@class='col-xs-4 pull-right']" position="before">
				<div class="col-xs-8" t-if="o.type == 'out_invoice' or o.type == 'out_refund' ">
					<table class="table table-condensed">

						<tr class="border-black">
							<td>Elaborate:</td>
							<td>Information for delivery:</td>
						</tr>

						<tr class="border-black">
							<td>
								<span>Name:</span>
								<span t-field="o.user_id" />
							</td>
							<td>
								<div>
									<span>Delegate:</span>
									<span t-field="o.delegate_id" />
								</div>
								<div>
									<span>Mean Transport:</span>
									<span t-field="o.mean_transp" />
								</div>
								<div>
									<span>Signature for receive</span>
								</div>
							</td>
						</tr>
					</table>
				</div>

			</xpath>

                 <xpath expr="//table//span[@t-field='o.amount_untaxed']" position="before">
                    <span t-if="o.type == 'out_refund'">(</span>
                 </xpath>
    
                 <xpath expr="//table//span[@t-field='o.amount_untaxed']" position="after">
                    <span t-if="o.type == 'out_refund'">)</span>
                 </xpath>
    
                 <xpath expr="//table//span[@t-field='o.amount_tax']" position="before">
                    <span t-if="o.type == 'out_refund'">(</span>
                 </xpath>
    
                 <xpath expr="//table//span[@t-field='o.amount_tax']" position="after">
                    <span t-if="o.type == 'out_refund'">)</span>
                 </xpath>
    
                 <xpath expr="//table//span[@t-field='o.amount_total']" position="before">
                    <span t-if="o.type == 'out_refund'">(</span>
                 </xpath>
    
                 <xpath expr="//table//span[@t-field='o.amount_total']" position="after">
                    <span t-if="o.type == 'out_refund'">)</span>
                 </xpath>

			<xpath expr="//div[@t-if='o.tax_line']" position="replace">

			</xpath>

			<xpath expr="//p[@t-if='o.payment_term.note']" position="after">
				<p t-if="o.date_due">
					<t t-if="o.date_due!=o.date_invoice">
						<strong>Date Due:</strong>
						<span t-field="o.date_due" />
					</t>
				</p>
			</xpath>

			<xpath expr="//p[@t-if='o.comment']" position="after">
				<small t-if="o.type == 'out_invoice' or o.type == 'out_refund'">
					<div>Printing and numbering system of its own under Law 571/2003 on the Fiscal Code, with subsequent amendments and OMPF 2226/2006</div>

					<t t-if="not res_company.stamp_image">
						<div>Invoice circulate without signature and stamp according to the law 571/2003, rule 115, paragraph 6</div>
					</t>
					<img t-if="res_company.stamp_image" t-att-src="'data:image/png;base64,%s' % res_company.stamp_image" style="max-height: 200px; " />
				</small>

				<div t-if="o.type == 'out_invoice' and o.payment_ids">
					<br />
					<br />
					<div t-foreach="o.payment_ids" t-as="payment" style="border-top: 1px solid black;">

						<t t-if="payment.credit != 0 and payment.journal_id.type == 'cash'">

							<div>
								<strong t-field="res_company.partner_id.name" />
							</div>
							<div>
								VAT:
								<span t-field="res_company.partner_id.vat" />
							</div>
							<div>
								NRC:
								<span t-field="res_company.partner_id.nrc" />
							</div>
							<address t-field="res_company.partner_id" t-field-options='{"widget": "contact", "fields": ["address"], "no_marker": true, "no_tag_br": true}' />
							<h4>
								<span>Voucher:</span>
								<span t-field="payment.ref" />
								<span>/</span>
								<span t-field="payment.date" />
							</h4>
							<div>
								<span>I received from</span>
								<strong t-field="o.partner_id.name" />
								<span t-if="o.partner_id.city">
									from
									<span t-field="o.partner_id.city" />
									<span t-field="o.partner_id.street" />
									<span t-field="o.partner_id.street2" />
								</span>
								,
								<span>amount</span>

								<span t-field="payment.credit" t-field-options='{"widget": "monetary", "display_currency": "o.currency_id"}' />
								(
								<span t-esc="convert(payment.credit)" />
								)
							</div>
							<div>
								Representing counter value of invoice
								<span t-field="o.number" />
							</div>

						</t>

					</div>
				</div>
			</xpath>


		</template>

		<template id="report_header_custom" inherit_id="report.external_layout_header">
			<xpath expr="//div[@class='header']" position="replace">
				<div class="header">
					<div class="row">
						<div class="col-xs-3">
							<img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 45px;" />
						</div>
						<div class="col-xs-9 text-right" style="margin-top:20px;" t-field="company.rml_header1" />
					</div>
					<div class="row zero_min_height">
						<div class="col-xs-12">
							<div style="border-bottom: 1px solid black;"></div>
						</div>
					</div>

				</div>
			</xpath>
		</template>


	</data>
</openerp>
